<!DOCTYPE html>
<html version="0.0.7">
<head>
<meta charset="UTF-8">
<title>【取扱説明書】HTML5エフェクトジェネレーター Ver.</title>
<style>
body {
  color: #444;
  background: #f8f8f8;
  font-size: 16px;
}
.links li {
  margin-bottom: 4px;
}
.image-description {
  text-align: center;
  padding: 10px;
}
.image-description img {
  display: inline-block;
  border: 1px solid #ccc;
}
.main {
  border: 1px solid #eee;
  box-shadow: 3px 3px 10px #eee;
  width: 980px;
  height: auto;
  padding: 40px;
  box-sizing: border-box;
  background: #fff;
  margin: 40px auto;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  position: relative;
  z-index: 2;
}
a {
  color: #999;
}
.rireki {

}
.rireki td {
  border: none;
  text-align: left;
  vertical-align: top;
  padding: 2px;
}
.rireki td:nth-child(1) {
  padding-right: 20px;
  color: #999;
}
h1 {
  text-align: center;
  font-size: 32px;
  margin-top: 70px;
}
h2 {
  margin-top: 150px;
  color: #fff;
  background: #444;
  width: 900px;
  font-size: 24px;
  box-sizing: border-box;
  padding: 5px 10px;
}
h3 {
  color: #fff;
  background: #444;
  display: inline-block;
  font-size: 20px;
  margin-top: 50px;
  padding: 5px 10px;
}
h4 {
  border-left: 4px solid #444;
  margin-top: 50px;
  font-size: 16px;
  padding: 5px 10px;
}
div ol, div ul {
  margin-bottom: 20px;
}
th, td {
  border: solid 1px #888;
  padding: 6px;
}
.yellow-cell {
  background: #ff9;
}
.param-table tr:nth-child(1) {
  font-weight: bold;
}
.param-table tr:nth-child(1),
.param-table tr td:nth-child(1),
.param-table tr td:nth-child(3),
.param-table tr td:nth-child(4) {
  text-align: center;
}
pre {
  font-size: 16px;
  border: 1px solid #bbb;
  background: #f9f9f9;
  border-radius: 6px;
  padding: 20px;
  margin: 30px 0px;
  box-sizing: border-box;
  width: 900px;
}
table {
  border-collapse:  collapse;
}
.mini {
  font-size: 80%;
}
.icon {
  margin: 5px 0px;
}
.icon .mini {
  color: #999;
}
.icon:before {
  content: "";
  display: inline-block;
  width: 22px;
  height: 22px;
  vertical-align: middle;
  background-size: contain;
  transform: translateY(-2px);
  margin-right:10px;
  margin-left: 25px;
}
.icon-chrome:before {
  background-image: url("data:image/png;base64,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");
}
.icon-directory:before {
  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACRElEQVRYhe2VP2sUURTFz73vZTczbMiaRA1kG4PB0lhrCsvgV7FJZWMnFgp+CAs77SzsBdEumhQ2FiLBqKjZZOf/vHssNpG10FiEGcEcePDehTfnx7mXN8Cp/nfJ5GFve2Ou2v+wTqvPQ7gIkUUBzhE4APFRRXYN9snFF1/Nrz7YPgkAP3kIpd1mSDagHgIBSGC8A0AYCTCA9egZgPWTAPiZwN77p2eqz0/eoPw2gOgfrhBwM0Pfu3RXICMCJWGlggWB0kIo1WlB1KVVVem8FqEsykArfciLKnwvs7w7vHD9Yf5LAvWXx49QfR1A/e+9j5jtYLbee3l/shom9nYECqA+rOlh3dEw0zv7AsBVAJDRu5s3WO7cIrB2jPOJ6TD259JZuufFxXeI6orIVFP+Y7FaExf3VNz88jigpqUQN7+stHSzBXcAAC3dVIbh1tHANGwPhuGWUnzWgvsYQXymIj5pC0DEJwowbQsAYKpCS9qaAaElKqzaawGrRNFZSNH0IwQAMgV0FlI1dtO2HiJjN1WljsZ/vybngIAo1OlITf1+Wy0w8/vqO/2ExqJpfxoL3+knGnQuEUHeNIAI8qBzicZukBChcQAi5LEbJIr+agKGxlsAhgL91URFpBKNdsEaYHXMqv9yHf8d0WhXRCoPAL2V+Fr6NrscJF7yndlpk24sLo5EpyNgKhb1EaQTES5W8ZGoj8wkVnURAJiFTJUprc6MdSYIKVhmtDoDqpSWZwxppizSuhzmjulOvBK/bjz1U/2T+gHpAkeouq8XggAAAABJRU5ErkJggg==");
}
.icon-text:before {
  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACj0lEQVRYhb1XPa/aMBQ9DuERqYKtUyU6MSD1Z3RkYAGJsa34IfyR9rXLq5D4BQyETghFLBUw0KFLO1RMUEpeSXw75IV82Y4DqJeP2Ma+5/je40vCkDLHccr1ev21YRjPANTCj2EYVQA1MFYDQCDaAdgB2Hke3xP5OwC7w+Hw23GcL91u95j2LTIzPTCfz//O53OdtUpbr9cvms3mz8IEAKDf74OIAAB0/goaQZMBRPHLecrx+AefHx4wmUx+bDabRqPR+KYiYOjsJjKmPbPX62E8Hm9Wq9WriwlQpp8ekRvnHJ1OB7Ztf10uly8LESAkoq5h2Umcc3DO0W63MZ1Ovy8Wi+faBMR+w04s8QjzH6Um1E5IgHOOVquF2Wz2azgcltIQQhEmQxAMnMUXH6WsKkyzDAAYjUYZt9vt1ks7ERMQQItQ2ZltdA7uynd48/ZdwsPTG/cf3mf8CwnQ0ysyFoGneFAmBhSfdu4zJj5BORGILQq9Cs7+uSUSbI6IJQTCHcc8xIIQgBOSBEV4+UdIIkISKkwMnolDAj+PgkQDyKSdIR72FLgQRa9oyTWQiDwJxSbnQFq7VxJILmbiXy7XXj4BpUtxMxoRMhJTkhDIlEI9YBW+GEhRiiUrlaGV5T2oRAUIpJDU+SSlFkCZipFPQJIAwSzIdx0DV1kBEWaBY5eLwBUEJCLQTYsmuJwAQXhs9G6Oity4XaWB64CVBP4H8PUErgRWExCWzZzzfksCRMWeAXRM5k3yXHBb8MBpgT+jTx/vb09AYsISPZlMTABWtVq1yuWy5Xklq1TyrEqlUvEYswzft3zGLMaYBQBE5JaIXM65S2S6nD8++r7vnk4n1zRNd7/fu7Ztu4PBwEtj/QOeCVSiuoMQYAAAAABJRU5ErkJggg==");
}
.kihon-kozo {
  color: black;
}
.tag {
  font-weight: bold;
  background-color: #ffcbc7;
}
.pname {
  font-weight: bold;
  background-color: #a8e4ff;
}
.pvalue {
  font-weight: bold;
  background-color: #ffe892;
}
.param-table {
  box-sizing: border-box;
  width: 900px;
}
.param-table tr td:nth-child(2) {
  width: 600px;
}
.hidden {
  opacity: 0;
  color: #fff;
}
.menu ul {
  margin: 0;
  list-style-type: none;
  position: relative;
  padding-left: 32px;
}
.menu>ul {
  padding-left: 0;
}
.menu ul li {
  cursor: pointer;
  margin: 4px;
}
.menu ul li:hover {
  background: #eee;
  color: #666;
}
.menu a {
  color: #888;
  text-decoration: none;
}
.menu {
  padding: 40px;
  color: #888;
  position: fixed;
  top: 0;
  left: 0;
  z-index: 1;
}
</style>
<script type="text/javascript">
function init() {
  var VERSION = document.getElementsByTagName('html')[0].getAttribute('version');
  document.title.replace('Ver.', 'Ver.' + VERSION);
  var str = document.getElementById('title').innerText;
  document.getElementById('title').innerText = str.replace('Ver.', 'Ver.' + VERSION);
  var html = '';
  var h2s = document.getElementsByTagName('h2');
  var id = '';
  for (var i = 0; i < h2s.length; i++) {
    var h2 = h2s[i];
    id = 'link-' + i;
    h2.id = id;
    html += '<a href="#'+id+'"><li>' + h2.textContent + '</li></a><ul>'
    var div = h2.nextElementSibling;
    var h3s = div.getElementsByTagName('h3');
    for (var j = 0; j < h3s.length; j++) {
      var h3 = h3s[j];
      id = 'link-' + i + '-' + j;
      h3.id = id;
      html += '<a href="#'+id+'"><li>' + h3.textContent + '</li></a>'
    };
    html += '</ul>';    
  };
  document.getElementById('menu-ul').innerHTML = html;
}
</script>
</head>
<body onload="init()">

<section class="menu">
  <b style="padding-left: 5px;">目次</b>
  <ul id="menu-ul">
  </ul>
</section>
<section class="main">

<h1 id="title">HTML5エフェクトジェネレーター Ver. 取扱説明書</h1>

<h2 style="margin-top: 100px;">このツールは何？</h2>
<div>
  <p>OBSによるライブ配信に投稿された特定のコメントに反応して、<br>自動で配信画面上にエフェクト（画像、音声、映像）を出力するツールです。</p>
  <p>これを使えば、たとえば「初見」を含むコメントが投稿されたときに<br>「初見さんいらっしゃい」という画像を表示する、ということが可能です。</a>
</div>

<h2>構成ファイル</h2>
<div>
  <p>このツールは以下の内容で構成されています。</p>
  <p>
    <p class="icon icon-directory">Effects<span class="mini">（サンプル素材フォルダ。不要な素材は削除してかまいません）</span></p>
    <p class="icon icon-directory">EffectGeneratorLibs<span class="mini">（プログラム）</span></p>
    <p class="icon icon-chrome">EffectGenerator.html<span class="mini">（設定ファイル）</span></p>
    <p class="icon icon-chrome">EffectGenerator説明書.html<span class="mini">（いま見てるコレ）</span></p>
    <p class="icon icon-text">★これは初めて入手する方向けのデータです<span class="mini">（注意喚起用。削除してかまいません）</span></p>
  </p>
</div>

<h2>導入に必要なもの</h2>
<div>
  <p>このツールが使用可能な配信ソフトは<b>OBS Studio</b>です。<br>
     (動作確認していませんが、たぶん<b>Streamlabs OBS</b>のほうでも動くと思います。)</p>
  <p>このツールは下記の2ツールと連携することで動作します。<br>
     あらかじめ導入しておいてください。</p>
  <ul>
    <li><b>マルチコメントビューア</b> (<a href="https://ryu-s.github.io/app/multicommentviewer" target="_blank">link</a>)</li>
    <li><b>HTML5コメントジェネレーター</b> (<a href="https://www.kilinbox.net/2016/01/HCG.html" target="_blank">link</a>)</li>
  </ul>
  <p>また、このツールをお使いいただくにあたっては、<br>パソコンを「ファイル名拡張子を表示する」設定にしておくことをお勧めします。</p>
  <p>拡張子が表示されていない（あるいは拡張子が何のことかわからない）場合、<br>「windows〇〇 拡張子 表示」で検索してみてください。<br>
</div>

<h2>OBS Studioへの導入</h2>
<div>
  <p>当ツールの構成内容は、すべて、HTML5コメントジェネレーターの<br>「<b>setting.xml</b>」や「<b>CommentGenerator.html</b>」がある場所と同じ階層に置いてください。</p>
  <p class="image-description"><img src="EffectGeneratorLibs/sample-file-position.png"><br>図. こんな感じになるように</p>
  <p>その後OBS Studioを起動し、以下の設定を行います。</p>
  <ol>
    <li>ソースの追加</li>
    <ol>
      <li>ソース欄のプラスボタンを押して「ブラウザ」を選択する。</li>
      <li>新規作成で、好きなソース名を入力する。</li>
      <li>「OK」を押す。</li>
    </ol>
    <li>プロパティの設定</li>
    <ol>
      <li>「ローカルファイル」にチェックを入れる。</li>
      <li>Local file行の右端の「参照」を押して「EffectGenerator.html」を探し、選択して「開く」。</li>
      <li>「幅」と「高さ」を入力する。配信の出力サイズに合わせることを推奨（960x540, 1280x720, 1920x1080など）。★<b>ここで設定した幅と高さと同じ値を、後述する「全体の設定」でも設定してください。</b></li>
      <li>「OBSに音声を再ルーティングする」にチェックを入れる。</li>
      <li>「表示されていないときにソースをシャットダウン」にチェックを入れる。</li>
      <li>「OK」を押す。</li>
    </ol>
    <li>オーディオの詳細プロパティの設定</li>
    <ol>
      <li>音声ミキサー欄の各ソース右端にある歯車ボタン（どれでもよい）を押して「オーディオの詳細プロパティ」を選択する。</li>
      <li>エフェクトジェネレータ―の行の「音声モニタリング」について、<br>エフェクトの音を、配信しながら自分も聞きたいなら「モニターと出力」、<br>視聴者が聞ければそれでよくて自分は聞かなくていいなら「モニターオフ」を選択する。</li>
      <li>「閉じる」を押す。</li>
    </ol>
    <li>クロマキーの設定<span class="mini">（必要なら）</span></li>
    <ol>
      <li>ソース欄のエフェクトジェネレータ―を右クリックして「フィルタ」を選択する。</li>
      <li>「エフェクトフィルタ」欄のプラスボタンを押して「クロマキー」を選択して「OK」を押す。</li>
      <li>「色キーの種類」で「Custom」を選択する。</li>
      <li>「色を選択」を押して、自分が使用するBB素材の背景色を指定して「OK」を押す。</li>
      <li>「類似性（1-1000）」を200～300に設定する。（適宜調整してください）</li>
      <li>「閉じる」を押す。</li>
    </ol>
  </ol>
</div>

<h2>エフェクトの登録</h2>
<div>
  <p>エフェクトの登録は、<b>「EffectGenerator.html」を直接編集</b>することで行います。
  <br>このファイルを「メモ帳」などのエディタで開いて編集してください。</p>
  <p>編集した後は必ず<b>上書き保存</b>を行いましょう。その際にOBSを起動している場合は、<br>編集をOBSに反映させるために<b>OBSのブラウザソースを更新</b>しましょう。<br>
  <span class="mini">（「表示されていないときにソースをシャットダウン」にチェックを入れていれば、<br>ソース右側の目玉ボタンを2回押して非表示化→表示化することでブラウザソースを更新できます）</span></p>
  <p><u>以下、説明が多くて「ウッ」となるかもしれませんが、基本的には、
  <br>「すでに登録してあるエフェクトをコピペしてsrcやwordなどを変えるだけ」で済みます。</u></p>
  
  <h3>全体の設定</h3>
  <p>全体設定は次のような構造になっています。</p>
  <pre class="kihon-kozo"><span class="tag">&lt;canvas</span> <span class="pname">width</span>="<span class="pvalue">1280</span>" <span class="pname">height</span>="<span class="pvalue">720</span>" <span class="tag">>&lt;/canvas></span></pre>
  <p><span class="tag">赤い部分は設定の種類</span>を意味します。（あんまり気にしなくて大丈夫です）
  <br>この部分は変更しないようにしてください。このあいだにパラメータを書いていきます。</p>
  <p>パラメータはそれぞれ「パラメータ名」と「設定値」のふたつで構成されています。
  <br><span class="pname">青い部分がパラメータ名</span>で、<span class="pvalue">黄色の部分が設定値</span>です。
  <br>パラメータを設定する際には次のルールに従ってください。</p>
    <ul>
      <li><span class="pname">パラメータ名</span>と<span class="pvalue">設定値</span>は「半角のイコール」で繋いでください。</li>
      <li><span class="pvalue">設定値</span>は「半角のダブルクォーテーション」で囲んでください。</li>
      <li>パラメータとパラメータの間には「ひとつ以上の半角スペース」を挟んで下さい。</li>
    </ul>
  </p>
  <h4>パラメータ一覧</h4>
  <p>画面サイズ、全体の音量の調節、その他全般的な設定をすることができます。
  <br>widthとheightは省略不可。配信の出力サイズに合わせて設定するとよいでしょう。
  <br>あとのパラメータはすべて省略可能です。</p>
  <table class="param-table">
    <tr><td>パラメータ名</td><td>説明</td><td>省略可</td><td>省略した場合</td></tr>
    <tr><td>width</td><td>画面全体の幅。</td><td>×</td><td></td></tr>
    <tr><td>height</td><td>画面全体の高さ。</td><td>×</td><td></td></tr>
    <tr><td>volume</td><td>全体の音量。0～100で指定する。ここで指定した音量に、さらに音声素材に個別に設定した音量を掛けたものが、最終的に再生されるときの音量になる。</td><td>○</td><td>50</td></tr>
    <tr><td>butting</td><td>エフェクトAを再生している最中に別のエフェクトBが再生されようとしたときに、どう処理するかの設定。Bを完全に無視するならば「ignore」、Aを即中断してBを再生するならば「stop」、Aの後でBを再生するならば「wait」を設定する。<span class="mini">（同時に再生できるようにするのはいまの設計上難しい…）</span><td>○</td><td>ignore</td></tr>
    <tr><td>demo</td><td>登録したエフェクトの自動デモプレイを再生するための設定。「true」にしておくと、OBSでソースを表示したときに自動でエフェクトのデモプレイが流れる<span class="mini">（ブラウザで動作確認している場合は「自動デモ」ボタンを押すことでデモを開始できる）</span>。<u>配信するときは「false」にしておくこと。</u></td><td>○</td><td>false</td></tr>
    <tr><td>FPS</td><td>1秒間に何回画面を書き換えるか。増やすと動作が重くなる。30以下推奨。</td><td>○</td><td>30</td></tr>
    <tr><td>flushcomment</td><td>戯れに実装した機能。「true」にすると、どこかから怒られそうな感じでコメントが配信画面に流れる。</u></td><td>○</td><td>false</td></tr>
  </table>
  <h4>設定例</h4>
  <pre>&lt;canvas width="1280" height="720" butting="stop" volume="50">&lt;/canvas></pre>
  
  <h3>各エフェクトの設定</h3>
  <p>エフェクトには「画像」「音声」「映像」の三種類あります。<br>それぞれ、次のような構造になっています。</p>
  <pre class="kihon-kozo"><span class="tag">&lt;img</span>   <span class="pname">src</span>="<span class="pvalue">assets/sample.gif</span>" <span class="pname">word</span>="<span class="pvalue">こんにちは</span>" <span class="tag">></span>
<span class="tag">&lt;audio</span> <span class="pname">src</span>="<span class="pvalue">assets/sample.mp3</span>" <span class="pname">word</span>="<span class="pvalue">初見</span>" <span class="tag">>&lt;/audio></span>
<span class="tag">&lt;video</span> <span class="pname">src</span>="<span class="pvalue">assets/sample.mp4</span>" <span class="pname">word</span>="<span class="pvalue">ナイス</span>" <span class="tag">>&lt;/video></pre>
  <h4>共通のパラメータ一覧</h4>
  <p>「画像」「音声」「映像」いずれのエフェクトも、共通のパラメータとして以下のものを持っています。<br>srcとwordは省略不可です。（他は省略してよい）</p>
  <table class="param-table">
    <tr><td>パラメータ名</td><td>説明</td><td>省略可</td><td>省略した場合</td></tr>
    <tr><td>src</td><td>素材ファイルの場所。省略不可。</td><td>×</td><td></td></tr>
    <tr><td>word</td><td>反応するコメント。「太郎,たろう,タロウ」のようにカンマ区切りで複数指定できる（カンマの前後に空白を入れないこと）。wordパラメータは原則として省略不可だが、regexpパラメータを設定した場合に限り、省略可。</td><td>×</td><td></td></tr>
    <tr><td>priority</td><td>優先度。整数で指定する。コメントとwordパラメータがマッチしたエフェクトが複数ある場合、これが大きいほうが優先される。</td><td>○</td><td>0</td></tr>
    <tr><td>fuzzy</td><td>曖昧に検索するかどうか。<u>「true」を指定すると表記ゆれに対応しやすくなる</u>。具体的には、「true」にした場合、コメントを《全角英数→半角英数》《アルファベット大文字→小文字》《半角カナ→全角カナ》《ひらがな→カタカナ》に変換してから判定を行う。<span class="mini">（たとえば、「*＊aAａＡあｱア」というコメントは「**aaaaアアア」に変換される。）</span></td><td>○</td><td>false</td></tr>
    <tr><td>match</td><td>コメントとwordがマッチしているかを判定する際の、判定の仕方を指定する。「コメントがwordを含むか？」で判定するなら「include」（初期値）、「wordで始まるか？」で判定するなら「first」、「wordで終わるか？」で判定するなら「last」、「wordに完全一致するか？」で判定するなら「equal」。</td><td>○</td><td>include</td></tr>
    <tr><td>regexp</td><td>正規表現が使用可能。これを設定した場合、word、fuzzyパラメータは無視される。たとえば「<span style="color: #44f;">^\d{4}$</span>」と設定すると、半角数字4文字なら「0123」でも「8888」でもすべてマッチする。<span class="mini">（正規表現に関する詳しい説明は省きます。「javascript 正規表現」などでググってみてください）</span></td><td>○</td><td></td></tr>
  </table>
  <h4>優先度について補足</h4>
  <p><u>エフェクトの候補が複数あって、しかもどれもpriorityパラメータが同じである場合</u>が考えられます。<br>
  その際は、以下のような規則でひとつのエフェクトが選択されます。</p>
  <ul style="font-weight: bold;">
    <li>
      <p style="font-weight: normal;"><b>「初見」にエフェクトA、「こんにちは」にエフェクトBが割り当てられていて<br>「初見です。こんにちは」というコメントが来た場合</b><br>
      <span class="hidden">｢</span><u>この場合、エフェクトBが優先されます</u>。<br>（マッチした文字列が最も長いものが優先される。「初見」は2文字、「こんにちは」は5文字）</p>
    </li>
    <li>
      <p style="font-weight: normal;"><b>「初見」に2つのエフェクトA、Bが割り当てられていて<bt>「初見です」というコメントが来た場合</b><br>
      <span class="hidden">｢</span><u>この場合、AとBのどちらかランダムで選択されます</u>。<br>（「マッチした文字列が最も長いもの」がひとつに絞れない場合、ランダムに決定される）</p>
    </li>
  </ul>
  
  <h3>画像エフェクト</h3>
  <p>画像エフェクトを表示します。
  <br>対応するファイル形式はpng, gif, jpgなど。
  <br><u>GIF動画も画像エフェクトです</u>。ご注意ください。</p>
  <h4>パラメータ一覧</h4>
  <table class="param-table">
    <tr><td>パラメータ名</td><td>説明</td><td>省略可</td><td>省略した場合</td></tr>
    <tr><td>time</td><td>表示する時間（秒単位）。</td><td>○</td><td>2</td></tr>
    <tr><td>fade</td><td>フェードイン･アウトする時間（秒単位）。</td><td>○</td><td>0</td></tr>
    <tr><td>x</td><td>x座標。ゼロだと左端に表示する。</td><td>○</td><td>0</td></tr>
    <tr><td>y</td><td>y座標。ゼロだと上端に表示する。</td><td>○</td><td>0</td></tr>
    <tr><td>width</td><td>幅。省略すると、素材の元サイズでそのまま表示される。</td><td>○</td><td>元サイズ</td></tr>
    <tr><td>height</td><td>高さ。省略すると、素材の元サイズでそのまま表示される。</td><td>○</td><td>元サイズ</td></tr>
    <tr><td>se</td><td>効果音名を指定すると、効果音が付けられる。効果音の登録方法は下記参照。</td><td>○</td><td>効果音なし</td></tr>
  </table>
  <h4>設定例</h4>
  <pre>&lt;img src="assets/sample-image.gif" word="サンプル画像" fade="0.5" time="3" se="piko"></pre>
  
  <h3>画像用効果音</h3>
  <p>これを登録しておくと、画像エフェクトに効果音を付けることができます。
  <br>ここで設定した「se」パラメータの値を、画像エフェクトの「se」パラメータにも設定してください。</p>
  <p>なお、<u>音声エフェクトとは別枠で登録する必要があります</u>。
  <h4>パラメータ一覧</h4>
  <table class="param-table">
    <tr><td>パラメータ名</td><td>説明</td><td>省略可</td><td>省略した場合</td></tr>
    <tr><td>se</td><td>効果音名。識別できればなんでもいい。</td><td>×</td><td></td></tr>
    <tr><td>volume</td><td>音量を0～100で指定する。</td><td>○</td><td>100</td></tr>
  </table>
  <h4>設定例</h4>
  <pre>&lt;audio src="assets/sample-piko.mp3" se="piko" volume="100" >&lt;/audio></pre>
  
  <h3>音声エフェクト</h3>
  <p>音声エフェクトを再生します。
  <br>対応するファイル形式はwav, mp3, ogg, m4aなど。</p>
  <h4>パラメータ一覧</h4>
  <table class="param-table">
    <tr><td>パラメータ名</td><td>説明</td><td>省略可</td><td>省略した場合</td></tr>
    <tr><td>volume</td><td>音量を0～100で指定する。</td><td>○</td><td>100</td></tr>
  </table>
  <h4>設定例</h4>
  <pre>&lt;audio src="assets/sample-audio.mp3" word="サンプル音声" volume="100" >&lt;/audio></pre>
  
  <h3>映像エフェクト</h3>
  <p>映像エフェクトを表示します。
  <br>対応するファイル形式はmp4, webmなど。</p>
  <h4>パラメータ一覧</h4>
  <p>以下のパラメータのほかに、x、y、width、height、volume、fadeが設定できます。
  <br>それらの意味は画像エフェクトや音声エフェクトと同じです。</p>
  <p>keycolorパラメータを指定するとクロマキー（特定の色を透明にする）機能が使えますが、
  <br>処理がけっこう重いので、不具合が生じる場合はOBS側のフィルタを使用してみてください。</p>
  <table class="param-table">
    <tr><td>パラメータ名</td><td>説明</td><td>省略可</td><td>省略した場合</td></tr>
    <tr><td>loop</td><td>ループに関する設定。再生する回数を1～10で指定する。省略した場合、ふつうに1回再生して終わり。</td><td>○</td><td>1</td></tr>
    <tr><td>keycolor</td><td>クロマキーの色の設定。ここで指定した色が透明になる。指定する場合は「#0000ff」のように「#RRGGBB」の形で指定する。あるいは「auto」を指定すると自動で判定を行う。「none」だとクロマキー無効で、デフォルトはこれ。</td><td>○</td><td>none</td></tr>
  </table>
  <h4>設定例</h4>
  <pre>&lt;video src="assets/sample-videp.mp4" word="サンプル映像" volume="100" keycolor="auto" >&lt;/video></pre>
</div>

<h2>エフェクトの動作確認</h2>
<div>
  <p>登録したエフェクトの動作確認をする方法を、以下の<b>A</b>～<b>C</b>に示します。</p>
  <p>とりあえず<b>A</b>で動作確認し、さらにクロマキーの設定やOBS上での動作を確認したい場合は<br><b>B</b>あるいは<b>C</b>（限定公開＋自演コメント）で動作確認するとよいでしょう。
  <ol style="list-style-type: upper-alpha; font-weight: bold;">
    <li>
      <p style="font-weight: normal; margin-bottom: 0;"><b>「EffectGenerator.html」を、エディタではなくGoogle ChromeなどのWebブラウザでふつうに開く。
      <br>画面下部にテスト用のボタンがあるので（見えなければズーム率を小さくしてみてください）それを押す。</b>
      <br>ただしこの方法で動作確認する場合、Webブラウザのセキュリティ上しょうがないのですが、<br>以下の機能が使用できません。<span class="mini">（OBSでは大丈夫なので安心してください）</span></p>
      <ul style="font-weight: normal;">
        <li>マルチコメントビューアとの連携</li>
        <li>クロマキー機能</li>
      </ul>
    </li>
    <li>
      <p style="font-weight: normal;"><b>「全体の設定」でデモプレイを有効にして（demo="true"を指定して）OBSを起動し、<br>OBSのプレビュー画面を確認する。</b>
      <br>これによって、OBSのプレビュー画面上で、登録したエフェクトのデモプレイを見ることができます。
      <br>ただしこの方法で動作確認する場合、テスト用のボタンが押せないため、任意のエフェクトを出すことができません。</p>
    </li>
    <li>
      <p style="font-weight: normal;"><b>実際に配信し、コメントしてみて、OBSのプレビュー画面を確認する。</b>
      <br>面倒ですが、これが一番確実です。</p>
    </li>
  </ol>
</div>

<h2>その他</h2>
<div>
  <h3>アップデートの利用方法</h3>
  <p>
  <a href="https://gungeespla.github.io/salmon_learn/navi.html" target="_blank">HTML5エフェクトジェネレーターのダウンロードページ</a>から、<br>
  最新版（アップデート用）をダウンロードしてください。<br>
  zipを展開して出てきた中身で既存のファイルを上書きすればアップデート完了です。
  </p>
  <p>
  <span class="mini">「★これは初めて入手する方向けのデータです」というファイルが入っている場合、<br>
  そのデータはアップデート用ではありませんので、上書きしないでください。</span>
  </p>
  <h3>アップデート履歴</h3>
  <table class="rireki">
    <tr><td>Ver.0.0.7</td><td>棒読みちゃんと連携できていなかった問題を修正。WebGL2に対応。</td></tr>
    <tr><td>Ver.0.0.6</td><td>プログラムの整備。</td></tr>
    <tr><td>Ver.0.0.5</td><td>ランダムに再生されるエフェクトを正しくテストできなかった件を修正。</td></tr>
    <tr><td>Ver.0.0.4</td><td>fuzzy="true"指定時にwordパラメータの値も曖昧化するように修正。</td></tr>
    <tr><td>Ver.0.0.3</td><td>一般公開に向けていろいろと整備。</td></tr>
    <tr><td>Ver.0.0.2</td><td>クロマキーの調整他。</td></tr>
    <tr><td>Ver.0.0.1</td><td>クロマキーがたまに機能していなかった件を修正。</td></tr>
    <tr><td>Ver.0.0.0</td><td>試作。</td></tr>
  </table>
  <h3>関連リンク</h3>
  <ul class="links">
    <li>マルチコメントビューア<br><a href="https://ryu-s.github.io/app/multicommentviewer" target="_blank">https://ryu-s.github.io/app/multicommentviewer</a></li>
    <li>HTML5コメントジェネレーター<br><a href="http://www.kilinbox.net/2016/01/HCG.html" target="_blank">http://www.kilinbox.net/2016/01/HCG.html</a></li>
    <li>HTML5コメントジェネレーター改<br><a href="http://ch.nicovideo.jp/twinstraycat/blomaga/ar1410238" target="_blank">http://ch.nicovideo.jp/twinstraycat/blomaga/ar1410238</a></li>
  </ul>
  <h3>謝辞</h3>
  <p>当ツールを製作するきっかけをくださり、<br>またデバッグにも協力してくださったおりまーたろう氏（<a href="https://twitter.com/bassodaisuki" target="_blank">@bassodaisuki</a>）、
  <br>改変元であるHTML5コメントジェネレーターを作ってくださったkilin氏（<a href="https://www.kilinbox.net/" target="_blank">link</a>）に感謝します。</p>
  <h3>免責</h3>
  <p>当ツールはご自由にお使いいただいてかまいませんが、
  <br>ご使用にあたって生じた不利益について作者は一切責任を負わないものとします。</p>
  <p style="text-align: center; margin: 50px;">ガンジー（<a href="https://twitter.com/gungeespla" target="_blank">@GungeeSpla</a>）</p>
</div>

</section>

</body>
</html>